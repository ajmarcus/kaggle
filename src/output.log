None
Usage: sklearn-example.py [options]

Options:
  -h, --help            show this help message and exit
  --report              Print a detailed classification report.
  --chi2_select=SELECT_CHI2
                        Select some number of features using a chi-squared
                        test
  --confusion_matrix    Print the confusion matrix.
  --top10               Print ten most discriminative terms per class for
                        every classifier.
  --all_categories      Whether to use all categories or not.

Loading 20 newsgroups dataset for categories:
['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']
data loaded
6773 documents (training set)
1693 documents (testing set)
12 categories

Extracting features from the training dataset using a sparse vectorizer
done in 2.442106s
n_samples: 6773, n_features: 9138

Extracting features from the test dataset using the same vectorizer
done in 0.516345s
n_samples: 1693, n_features: 9138

================================================================================
Perceptron
________________________________________________________________________________
Training: 
Perceptron(alpha=0.0001, class_weight=None, eta0=1.0, fit_intercept=True,
      n_iter=50, n_jobs=1, penalty=None, seed=0, shuffle=False, verbose=0,
      warm_start=False)
train time: 0.575s
test time:  0.003s
f1-score:   0.444
dimensionality: 9138
density: 0.511892

classification report:
             precision    recall  f1-score   support

          1       0.64      0.64      0.64       316
         10       0.28      0.23      0.26        64
         11       0.27      0.11      0.15        28
         12       0.08      0.27      0.12        11
          2       0.46      0.41      0.44       470
          3       0.43      0.41      0.42       415
          4       0.39      0.35      0.37       126
          5       0.02      0.17      0.03         6
          6       0.13      0.08      0.10        26
          7       0.00      0.00      0.00        22
          8       0.51      0.56      0.53       158
          9       0.23      0.39      0.29        51

avg / total       0.46      0.44      0.44      1693

confusion matrix:
[[202   0   1   4  84  19   1   3   0   1   1   0]
 [  0  15   1   3   0   0   1   0   1   0  26  17]
 [  0  14   3   1   0   1   0   0   0   0   4   5]
 [  0   2   0   3   0   0   0   0   0   0   2   4]
 [ 91   0   1   8 194 132  13  27   1   1   2   0]
 [ 20   0   1  14 134 169  55  20   2   0   0   0]
 [  0   0   0   1   9  67  44   2   1   1   1   0]
 [  0   1   0   0   0   0   0   1   0   0   3   1]
 [  0   0   1   0   0   0   0   2   2   3  14   4]
 [  0   3   0   0   0   0   0   1   0   0  15   3]
 [  0   8   3   3   0   0   0   1   8  13  89  33]
 [  1  10   0   0   0   1   0   0   0   0  19  20]]

================================================================================
kNN
________________________________________________________________________________
Training: 
KNeighborsClassifier(algorithm=auto, leaf_size=30, n_neighbors=10, p=2,
           warn_on_equidistant=True, weights=uniform)
train time: 0.001s
test time:  2.078s
f1-score:   0.451
classification report:
             precision    recall  f1-score   support

          1       0.50      0.70      0.58       316
         10       0.35      0.28      0.31        64
         11       0.00      0.00      0.00        28
         12       0.00      0.00      0.00        11
          2       0.45      0.41      0.43       470
          3       0.52      0.48      0.50       415
          4       0.49      0.30      0.37       126
          5       0.00      0.00      0.00         6
          6       0.00      0.00      0.00        26
          7       0.07      0.05      0.05        22
          8       0.48      0.77      0.59       158
          9       0.18      0.18      0.18        51

avg / total       0.45      0.47      0.45      1693

confusion matrix:
[[220   0   0   0  77  18   1   0   0   0   0   0]
 [  0  18   0   0   0   0   0   0   0   0  34  12]
 [  0   9   0   0   0   0   0   0   0   1  11   7]
 [  0   5   0   0   0   0   0   0   0   0   5   1]
 [177   0   0   0 191  94   8   0   0   0   0   0]
 [ 41   0   0   0 143 200  31   0   0   0   0   0]
 [  1   0   0   0  11  72  38   0   0   0   4   0]
 [  0   0   0   0   0   0   0   0   0   2   4   0]
 [  0   0   0   0   0   0   0   0   0   3  22   1]
 [  0   1   0   0   0   0   0   0   0   1  17   3]
 [  0  12   0   0   0   0   0   0   1   8 121  16]
 [  0   6   0   0   0   0   0   0   0   0  36   9]]

================================================================================
L2 penalty
________________________________________________________________________________
Training: 
LinearSVC(C=1.0, class_weight=None, dual=False, fit_intercept=True,
     intercept_scaling=1, loss=l2, multi_class=ovr, penalty=l2, tol=0.001,
     verbose=0)
train time: 1.127s
test time:  0.003s
f1-score:   0.506
dimensionality: 9138
density: 1.000000

classification report:
             precision    recall  f1-score   support

          1       0.64      0.67      0.66       316
         10       0.27      0.20      0.23        64
         11       0.00      0.00      0.00        28
         12       0.00      0.00      0.00        11
          2       0.52      0.53      0.53       470
          3       0.54      0.56      0.55       415
          4       0.46      0.30      0.37       126
          5       0.00      0.00      0.00         6
          6       0.40      0.08      0.13        26
          7       0.00      0.00      0.00        22
          8       0.51      0.76      0.61       158
          9       0.25      0.33      0.29        51

avg / total       0.50      0.52      0.51      1693

confusion matrix:
[[212   0   0   0  93  11   0   0   0   0   0   0]
 [  0  13   0   1   0   0   0   0   0   0  34  16]
 [  0  15   0   0   0   0   0   0   0   0   7   6]
 [  0   3   1   0   0   0   0   0   0   0   3   4]
 [100   0   0   0 251 108  10   0   0   0   1   0]
 [ 16   0   0   0 134 231  34   0   0   0   0   0]
 [  1   0   0   0   6  78  38   0   0   1   2   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0]
 [  1   1   0   0   0   0   0   0   2   1  19   2]
 [  0   1   0   0   0   0   0   0   1   0  18   2]
 [  0   6   0   0   0   1   0   0   2   8 120  21]
 [  0  10   0   0   0   0   0   0   0   0  24  17]]

________________________________________________________________________________
Training: 
SGDClassifier(alpha=0.0001, class_weight=None, epsilon=0.1, eta0=0.0,
       fit_intercept=True, learning_rate=optimal, loss=hinge, n_iter=50,
       n_jobs=1, penalty=l2, power_t=0.5, rho=0.85, seed=0, shuffle=False,
       verbose=0, warm_start=False)
train time: 0.697s
test time:  0.003s
f1-score:   0.511
dimensionality: 9138
density: 0.647999

classification report:
             precision    recall  f1-score   support

          1       0.63      0.69      0.66       316
         10       0.25      0.20      0.22        64
         11       0.00      0.00      0.00        28
         12       0.00      0.00      0.00        11
          2       0.54      0.53      0.54       470
          3       0.56      0.56      0.56       415
          4       0.42      0.32      0.36       126
          5       0.00      0.00      0.00         6
          6       0.43      0.12      0.18        26
          7       0.00      0.00      0.00        22
          8       0.51      0.81      0.62       158
          9       0.20      0.16      0.17        51

avg / total       0.50      0.53      0.51      1693

confusion matrix:
[[217   0   0   0  91   7   0   0   0   0   1   0]
 [  0  13   2   2   0   0   1   0   0   1  36   9]
 [  0  15   0   0   0   0   0   0   0   0   7   6]
 [  0   2   1   0   0   0   0   0   0   0   4   4]
 [103   0   0   0 251 101  13   0   0   0   2   0]
 [ 22   0   0   0 118 234  41   0   0   0   0   0]
 [  1   0   0   0   6  76  40   0   1   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0]
 [  1   1   0   0   0   0   0   0   3   1  19   1]
 [  0   1   0   0   0   0   0   0   0   0  19   2]
 [  0   6   4   0   0   1   0   0   3   5 128  11]
 [  1  14   0   0   0   0   0   0   0   0  28   8]]

================================================================================
L1 penalty
________________________________________________________________________________
Training: 
LinearSVC(C=1.0, class_weight=None, dual=False, fit_intercept=True,
     intercept_scaling=1, loss=l2, multi_class=ovr, penalty=l1, tol=0.001,
     verbose=0)
train time: 5.288s
test time:  0.004s
f1-score:   0.499
dimensionality: 9138
density: 0.055492

classification report:
             precision    recall  f1-score   support

          1       0.63      0.67      0.65       316
         10       0.25      0.22      0.23        64
         11       0.00      0.00      0.00        28
         12       0.00      0.00      0.00        11
          2       0.53      0.52      0.53       470
          3       0.54      0.57      0.55       415
          4       0.45      0.29      0.36       126
          5       0.00      0.00      0.00         6
          6       0.00      0.00      0.00        26
          7       0.00      0.00      0.00        22
          8       0.49      0.72      0.58       158
          9       0.20      0.27      0.23        51

avg / total       0.49      0.52      0.50      1693

confusion matrix:
[[212   0   0   0  93  11   0   0   0   0   0   0]
 [  0  14   0   0   0   0   0   0   1   1  34  14]
 [  1  12   0   0   0   0   0   0   0   0  10   5]
 [  0   5   0   0   0   0   0   0   0   0   2   4]
 [ 99   0   0   0 246 113  11   0   0   0   1   0]
 [ 25   0   0   0 120 236  34   0   0   0   0   0]
 [  1   0   0   0   8  77  37   0   0   1   2   0]
 [  0   1   0   0   0   0   0   0   0   0   5   0]
 [  0   1   0   0   0   0   0   0   0   2  20   3]
 [  0   1   0   0   0   0   0   0   0   0  18   3]
 [  0  10   0   0   0   1   0   0   2   6 113  26]
 [  0  13   0   0   0   0   0   0   0   0  24  14]]

________________________________________________________________________________
Training: 
SGDClassifier(alpha=0.0001, class_weight=None, epsilon=0.1, eta0=0.0,
       fit_intercept=True, learning_rate=optimal, loss=hinge, n_iter=50,
       n_jobs=1, penalty=l1, power_t=0.5, rho=0.85, seed=0, shuffle=False,
       verbose=0, warm_start=False)
train time: 2.336s
test time:  0.002s
f1-score:   0.487
dimensionality: 9138
density: 0.030915

classification report:
             precision    recall  f1-score   support

          1       0.62      0.66      0.64       316
         10       0.29      0.09      0.14        64
         11       0.10      0.04      0.05        28
         12       0.00      0.00      0.00        11
          2       0.52      0.52      0.52       470
          3       0.53      0.57      0.55       415
          4       0.43      0.25      0.32       126
          5       0.00      0.00      0.00         6
          6       0.00      0.00      0.00        26
          7       0.00      0.00      0.00        22
          8       0.46      0.84      0.59       158
          9       0.17      0.06      0.09        51

avg / total       0.48      0.51      0.49      1693

confusion matrix:
[[209   0   0   1  95  10   0   0   0   0   1   0]
 [  1   6   4   2   0   0   0   0   3   2  42   4]
 [  1   5   1   1   0   0   1   0   1   0  17   1]
 [  0   2   1   0   0   0   0   0   1   0   4   3]
 [100   0   0   2 243 112  11   0   0   0   2   0]
 [ 22   0   0   4 122 237  30   0   0   0   0   0]
 [  1   0   0   0   7  83  32   0   0   1   2   0]
 [  0   0   0   0   0   0   0   0   0   1   5   0]
 [  0   0   0   0   1   0   0   0   0   0  25   0]
 [  0   2   0   1   0   0   0   0   1   0  18   0]
 [  1   4   1   2   0   1   0   0   7   3 132   7]
 [  1   2   3   1   1   1   0   0   0   1  38   3]]

================================================================================
Elastic-Net penalty
________________________________________________________________________________
Training: 
SGDClassifier(alpha=0.0001, class_weight=None, epsilon=0.1, eta0=0.0,
       fit_intercept=True, learning_rate=optimal, loss=hinge, n_iter=50,
       n_jobs=1, penalty=elasticnet, power_t=0.5, rho=0.85, seed=0,
       shuffle=False, verbose=0, warm_start=False)
train time: 3.449s
test time:  0.002s
f1-score:   0.513
dimensionality: 9138
density: 0.273300

classification report:
             precision    recall  f1-score   support

          1       0.63      0.69      0.66       316
         10       0.20      0.16      0.18        64
         11       0.00      0.00      0.00        28
         12       0.00      0.00      0.00        11
          2       0.54      0.54      0.54       470
          3       0.56      0.57      0.57       415
          4       0.44      0.33      0.37       126
          5       0.00      0.00      0.00         6
          6       0.50      0.12      0.19        26
          7       0.00      0.00      0.00        22
          8       0.50      0.84      0.63       158
          9       0.21      0.16      0.18        51

avg / total       0.51      0.53      0.51      1693

confusion matrix:
[[217   0   0   0  92   6   0   0   0   0   1   0]
 [  0  10   1   1   0   0   1   0   0   1  41   9]
 [  0  15   0   0   0   0   0   0   0   0   7   6]
 [  0   2   1   0   0   0   0   0   0   0   4   4]
 [101   0   0   0 253 102  13   0   0   0   1   0]
 [ 21   0   0   1 119 236  38   0   0   0   0   0]
 [  1   0   0   1   5  75  41   0   1   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0]
 [  1   0   0   0   0   0   0   0   3   0  21   1]
 [  1   0   1   0   0   0   0   0   0   0  19   1]
 [  0   7   2   0   0   1   0   0   2   4 132  10]
 [  0  15   0   0   0   0   0   0   0   0  28   8]]

================================================================================
NearestCentroid (aka Rocchio classifier)
________________________________________________________________________________
Training: 
NearestCentroid(metric=euclidean, shrink_threshold=None)
train time: 0.020s
test time:  0.006s
f1-score:   0.298
classification report:
             precision    recall  f1-score   support

          1       0.39      0.74      0.51       316
         10       0.33      0.44      0.38        64
         11       0.18      0.07      0.10        28
         12       0.43      0.27      0.33        11
          2       0.40      0.31      0.35       470
          3       0.26      0.03      0.06       415
          4       0.22      0.50      0.30       126
          5       0.00      0.00      0.00         6
          6       0.19      0.27      0.22        26
          7       0.11      0.27      0.16        22
          8       0.47      0.36      0.41       158
          9       0.25      0.27      0.26        51

avg / total       0.34      0.34      0.30      1693

confusion matrix:
[[233   1   0   0  54  19   8   0   1   0   0   0]
 [  0  28   5   1   0   0   0   0   0   2  20   8]
 [  0  14   2   2   0   0   0   0   0   0   5   5]
 [  0   4   2   3   0   0   0   0   0   0   0   2]
 [253   0   0   0 147  16  53   0   0   1   0   0]
 [117   0   0   0 116  14 168   0   0   0   0   0]
 [  0   0   0   0  54   5  63   0   2   1   1   0]
 [  0   0   0   0   0   0   0   0   4   1   1   0]
 [  0   1   0   0   0   0   0   0   7  10   7   1]
 [  0   0   0   0   0   0   0   0   2   6  12   2]
 [  0  22   0   1   0   0   0   0  20  33  57  25]
 [  0  15   2   0   0   0   0   0   1   1  18  14]]

================================================================================
Naive Bayes
________________________________________________________________________________
Training: 
MultinomialNB(alpha=0.01, fit_prior=True)
train time: 0.017s
test time:  0.002s
f1-score:   0.421
dimensionality: 9138
density: 1.000000

classification report:
             precision    recall  f1-score   support

          1       0.53      0.58      0.55       316
         10       0.33      0.31      0.32        64
         11       0.00      0.00      0.00        28
         12       0.00      0.00      0.00        11
          2       0.48      0.50      0.49       470
          3       0.42      0.25      0.32       415
          4       0.29      0.56      0.39       126
          5       0.00      0.00      0.00         6
          6       0.00      0.00      0.00        26
          7       0.00      0.00      0.00        22
          8       0.50      0.85      0.63       158
          9       0.15      0.14      0.14        51

avg / total       0.42      0.45      0.42      1693

confusion matrix:
[[183   0   0   0  91  33   7   0   0   0   2   0]
 [  0  20   0   0   0   0   0   0   0   0  32  12]
 [  0  13   0   0   0   0   0   0   0   0   9   6]
 [  0   4   0   0   0   0   0   0   0   0   2   5]
 [126   1   0   0 234  72  36   0   0   0   1   0]
 [ 36   0   0   0 146 105 128   0   0   0   0   0]
 [  0   0   0   0  13  38  71   0   0   0   4   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0]
 [  0   1   0   0   0   0   0   0   0   0  24   1]
 [  0   2   0   0   0   0   0   0   0   0  19   1]
 [  0   9   0   0   0   0   0   0   1   0 134  14]
 [  0  10   0   0   0   0   0   0   0   0  34   7]]

________________________________________________________________________________
Training: 
BernoulliNB(alpha=0.01, binarize=0.0, fit_prior=True)
train time: 0.026s
test time:  0.014s
f1-score:   0.387
dimensionality: 9138
density: 1.000000

classification report:
             precision    recall  f1-score   support

          1       0.51      0.66      0.58       316
         10       0.32      0.39      0.35        64
         11       0.00      0.00      0.00        28
         12       0.00      0.00      0.00        11
          2       0.49      0.42      0.45       470
          3       0.40      0.13      0.19       415
          4       0.26      0.75      0.38       126
          5       0.00      0.00      0.00         6
          6       0.33      0.08      0.12        26
          7       0.00      0.00      0.00        22
          8       0.52      0.70      0.60       158
          9       0.21      0.29      0.25        51

avg / total       0.42      0.42      0.39      1693

confusion matrix:
[[210   0   0   0  65  25  14   0   1   0   1   0]
 [  0  25   1   0   0   0   0   0   0   0  24  14]
 [  0  13   0   0   0   0   0   0   0   0   7   8]
 [  0   4   0   0   0   0   0   0   0   0   2   5]
 [159   1   0   0 197  40  72   0   0   0   1   0]
 [ 45   0   0   0 132  53 185   0   0   0   0   0]
 [  0   0   0   0  12  16  94   1   0   0   3   0]
 [  0   0   0   0   0   0   0   0   1   0   4   1]
 [  0   2   0   0   0   0   0   0   2   1  20   1]
 [  0   3   0   0   0   0   0   0   0   0  17   2]
 [  0  19   1   0   0   0   0   0   2   1 111  24]
 [  0  12   1   0   0   0   0   0   0   0  23  15]]

================================================================================
LinearSVC with L1-based feature selection
________________________________________________________________________________
Training: 
L1LinearSVC(C=1.0, class_weight=None, dual=True, fit_intercept=True,
      intercept_scaling=1, loss=l2, multi_class=ovr, penalty=l2,
      tol=0.0001, verbose=0)
train time: 5.700s
test time:  0.008s
f1-score:   0.504
dimensionality: 2930
density: 0.875427

classification report:
             precision    recall  f1-score   support

          1       0.63      0.68      0.66       316
         10       0.27      0.22      0.24        64
         11       0.25      0.04      0.06        28
         12       0.00      0.00      0.00        11
          2       0.53      0.52      0.52       470
          3       0.53      0.56      0.55       415
          4       0.46      0.29      0.35       126
          5       0.00      0.00      0.00         6
          6       0.25      0.04      0.07        26
          7       0.00      0.00      0.00        22
          8       0.51      0.74      0.60       158
          9       0.24      0.31      0.27        51

avg / total       0.50      0.52      0.50      1693

confusion matrix:
[[216   0   0   0  88  12   0   0   0   0   0   0]
 [  0  14   2   1   0   0   1   0   0   1  32  13]
 [  0  15   1   0   0   0   0   0   0   0   6   6]
 [  0   4   0   0   0   0   0   0   0   0   3   4]
 [102   0   0   0 245 115   7   0   0   0   1   0]
 [ 21   0   0   0 125 234  35   0   0   0   0   0]
 [  1   0   0   0   6  80  36   0   0   1   2   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0]
 [  1   1   0   0   0   0   0   0   1   1  19   3]
 [  0   1   0   0   0   0   0   0   0   0  19   2]
 [  0   6   1   0   0   0   0   0   3   9 117  22]
 [  0  11   0   0   0   0   0   0   0   0  24  16]]

Test Time: [ 0.00123425  1.          0.00166162  0.00120808  0.00172026  0.00119764
  0.00119328  0.00300879  0.00117549  0.00678016  0.00398735]
Training Time: [  1.00932775e-01   1.62453846e-04   1.97746400e-01   1.22318377e-01
   9.27702266e-01   4.09896024e-01   6.04999496e-01   3.55972180e-03
   3.03588762e-03   4.56493634e-03   1.00000000e+00]
CLF Names: ['Perceptron', 'KNeighborsClassifier', 'LinearSVC', 'SGDClassifier', 'LinearSVC', 'SGDClassifier', 'SGDClassifier', 'NearestCentroid', 'MultinomialNB', 'BernoulliNB', 'L1LinearSVC']
Score: [0.44405290436532963, 0.4508846074653885, 0.50638834463066273, 0.5107124085113609, 0.49917204528252684, 0.48674322843246765, 0.51272490374070046, 0.29821398835404711, 0.42128986983841044, 0.38652660475570366, 0.50438044328820308]
